\section{Lecture: 11/12/2024}


\subsection{Modules over principal domains}

Recall that a principal domain is a commutative ring where 
every ideal is principal, i.e. generated by one element and 
such that $xy=0$ implies $x=0$ or $y=0$. 

\begin{theorem}
\label{thm:rango}
Let $R$ be a principal domain. If $F$ is a finitely generated free $R$-module and 
$N$ is a submodule of $F$, then $N$ is free and 
$\rank(N)\leq\rank(F)$. In particular, $N$ is finitely generated. 
\end{theorem}

\begin{proof}
	We proceed by induction on $n=\rank(F)$. Si $n=1$, then
	$F\simeq\prescript{}{R}R$ 
	and since $R$ is commutative the submodules of $F$ are exactly the ideals of $R$. In particular,
	$N=(r)$ for some $r\in R$. If $r=0$, then $N=\{0\}$ and the result holds. If $r\ne 0$, then 
	$\{r\}$ is basis of $N$ (since $R$ is a domain) and the result holds.
	
	Assume now that the result holds for all free modules of rank $<n$. Let $F$ be a free module of
	rank $n$ and 
	$\{f_1,\dots,f_n\}$ be basis of $F$. Let $F_n=(f_1,\dots,f_{n-1})$. By the inductive hypothesis, 
	$U=N\cap F_n$ is free of rank $\leq n-1$. Let 
	$\{n_1,\dots,n_k\}$ be a basis of $U$ (by convention, if $U=\{0\}$, then $k=0$). If 
	$f\in F$, there exist unique $r_1,\dots,r_n\in R$ such that  
	\[
	f=\sum_{i=1}^n r_i\cdot f_i.
	\]
	There exists a well-defined surjective homomorphism 
	\[
	\varphi\colon F\to R,
	\quad
	\sum_{i=1}^nr_i\cdot f_i\mapsto r_n.
	\] 
	If $\varphi(N)=\{0\}$, then $N\subseteq (f_1,\dots,f_{n-1})$ and thus $N=U$. 
	If $\varphi(N)\ne\{0\}$, then $\varphi(N)$ is an ideal of 
	$R$, say $\varphi(N)=(x)$ for some $x\in R\setminus\{0\}$. Let $n_{k+1}\in N$ 
	be such that $\varphi(n_{k+1})=x$. 
    We claim that $\{n_1,\dots,n_k,n_{k+1}\}$ is basis of $N$. We first proves that 
    this is a generating set. 
	If $n\in N$, then $\varphi(n)=rx$ 
	for some $r\in R$. Thus $n-r\cdot n_{k+1}\in N\cap\ker\varphi=N\cap F_n=U$, as  
	$\varphi(n-r\cdot n_{k+1})=0$. In particular, 
	\[
	n-r\cdot n_{k+1}\in (n_1,\dots,n_k)\implies  
	n\in (n_1,\dots,n_k,n_{k+1}).
	\]
	We claim that 
	$\{n_1,\dots,n_k,n_{k+1}\}$ is linearly independent. If 
	\[
	0=\sum_{i=1}^{k+1}r_i\cdot n_i,
	\]
	for some $r_1,\dots,r_{k+1}\in R$, then, since 
	$\varphi(n_i)=0$ for all $i\in\{1,\dots,k\}$,
	\[
	0=\varphi(r_{k+1}\cdot n_{k+1})=r_{k+1}x.
	\]
	This implies that $r_{k+1}=0$. Thus $\sum_{i=1}^kr_i\cdot n_i=0$. Since
	$\{n_1,\dots,n_k\}$ is basis of $U$, we conclude that 
	$r_1=\dots=r_k=0$. 
\end{proof}

The previous theorem also holds for infinite bases. However, 
the proof requires the use of Zorn's lemma. 
% reference?
	
% \begin{corollary}
% Sea $R$ un dominio de ideales principales. Si $M$ es proyectivo y finitamente generado, 
% entonces $M$ es libre.
% \end{corollary}

% \begin{proof}
% Supongamos que $M=(m_1,\dots,m_k)$. Sabemos que $M$ es sumando directo de un libre $F$. Fijemos una base de $F$ y sea 
% $X=\{f_1,f_2,\dots\}$ un subconjunto finito de esa base de $F$ tal que
% \[
% m_j=\sum_{i=1}^{n_j}r_{ij}\cdot f_i
% \]
% para ciertos $r_{ij}\in R$ y ciertos $n_1\dots,n_k\in\N$. 
% Por construcción, $X$ es linealmente indepdendiente y $M=(X)$. 
% \end{proof}

% El corolario anterior vale también para módulos arbitrarios. La demostración puede
% consultarse por ejemplo en~\cite[I, Theorem 5.1]{MR1438546}.

\begin{corollary}
Let $R$ be a principal domain. If $M$ is a finitely generated $R$-module and $N$ 
is a submodule of $M$, then $N$ is finitely generated.   
\end{corollary}

\begin{proof}
There exists a free module $F$ of finite rank and a surjective homomorphism
$\varphi\colon F\to M$. Since $N_1=\varphi^{-1}(N)$ is a submodule of $F$, 
the previous theorem implies that  
$\rank(N_1)\leq\rank F<\infty$. If $\{x_1,\dots,x_k\}$ is basis of $N_1$, then
$\{\varphi(x_1),\dots,\varphi(x_k)\}$ is a generating set of 
$\varphi(N_1)=\varphi(\varphi^{-1}(N))=N$, as 
$\varphi$ is surjective. $N$ is generated by 
$\leq k=\rank(N_1)\leq\rank(F)<\infty$ elements.  
\end{proof}

Some exercises:

\begin{exercise}
\label{xca:rank}
    Let $R$ be a principal domain and 
    let $M$ be a free $R$-module. If $S$ is a submodule of $M$ such that
    $M/S$ is free, then $M\simeq S\oplus (M/S)$. Moreover,  
	$S$ is free and 
	\[
	\rank(M)=\rank(S)+\rank(M/S).
	\] 
\end{exercise}

\begin{exercise}
\label{xca:n_elements}
    Let $R$ be a principal domain. 
    If $M$ is a free $R$-module of rank $n$, then
    every linearly independent subset of $M$ 
    contains at most $n$ elements. 
\end{exercise}

\begin{exercise}
    Let $R$ be a principal domain. 
    and $M$ and $N$ be free $R$-modules. Prove that 
    $M\simeq N$ if and only if $\rank(M)=\rank(N)$. 	
\end{exercise}

\begin{exercise}
\label{xca:base}
    Let $R$ be a principal domain. 
    If $M$ is a free $R$-module of finite rank $n$ and $\{s_1,\dots,s_n\}$ 
    is a generating set, then $\{s_1,\dots,s_n\}$ is a basis of $M$.
\end{exercise}

\index{Annihilator!of a module}
\index{Annihilator!of an element}
If $M$ is an $R$-module, the \emph{annihilator} of $M$ 
is defined as 
\[
\Ann(M)=\{r\in R:r\cdot m=0\text{ for all $m\in M$}\}.
\] 
For $m\in M$ let 
\[
\Ann(m)=\{r\in R:r\cdot m=0\}.
\]  
Note that $\Ann(M)=\bigcap_{m\in M}\Ann(m)$. 
It is an exercise to show that both 
$\Ann(M)$ and $\Ann(m)$ are ideals of $R$. 
If $r\in R$, the annihilator of $r$ in $M$ 
is defined as 
\[
\Ann_M(r)=\{m\in M:r\cdot m=0\}.
\] 
It is an exercise to show that $\Ann_M(r)$ is a submodule of 
$M$. 

\begin{exercise}
Let $M$ be an $R$-module and $m\in M$ be such that $\Ann(m)=(r)$ 
for some $r\in R$. 
Let $p\in R$ be an irreducible element. Prove the following statements: 
\begin{enumerate}
\item If $p$ divides $r$, then $(m)/(p\cdot (m))\simeq R/(p)$.
\item If $p$ does not divide $r$, then $p\cdot (m)=(m)$.
\end{enumerate}
\end{exercise}

% Demostremos la primera afirmación. Sea $\varphi\colon R\to (m)$, $s\mapsto s\cdot m$, y 
% sea $f=\pi\circ \varphi\colon R\to (m)/p\cdot (m)$, donde $\pi\colon (m)\to (m)/p\cdot (m)$ es 
% el epimorfismo canónico. Veamos que $\ker f=(p)$. Trivialmente vale 
% que $\ker f\supseteq (p)$. Por otro lado, si $s\in R$ es tal que
% s\cdot m\in p\cdot (m)$, entonces, como $r=pt$ para algún $t\in R$, $s\cdot m=t\cdot (p\cdot m)$.
% Como $f$ es epimorfismo por ser composición
% de epimorfismos, se tiene que $R/(p)\simeq (m)/p\cdot (m)$.  

% Demostremos ahora la segunda afirmación. Como $p$ y $r$ son coprimos, existen 
% $a,b\in R$ tales que $ap+br=1$. Como $r\cdot \m=0$ pues $\Ann(m)=(r)$, 
% $m=1\cdot m=(ap+br)\cdot m=p\cdot (a\cdot m)\in p\cdot (m)$.  

\index{Torsion!of a module}
\index{Torsion-free module}
\index{Torsion!module}
Let $R$ be an integral domain, the \emph{torsion} of an $R$-module $M$ 
is defined as the subset 
\[
T(M)=\{m\in M:r\cdot m=0\text{ for some non-zero $r\in R$}\}.
\]
It is an exercise to show that $T(M)$ is a submodule of $M$. 
A module $M$ 
\emph{is torsion-free} if $T(M)=\{0\}$ and it is 
a \emph{torsion} module if $T(M)=M$.  We also say that $M$ \emph{has torsion}
if $T(M)\ne\{0\}$. 

\begin{exercise}
If $M\simeq N$, then $T(M)\simeq T(N)$.
\end{exercise}

\begin{exercise}
Prove that $T(\bigoplus_{i\in I}M_i)\simeq \bigoplus_{i\in I}T(M_i)$.
\end{exercise}

\begin{exercise}
\label{xca:free}
    Let $R$ be a principal domain and $M$ be an $R$-module. Prove that
    if $M$ is finitely generated and $S\subseteq M$ is a free submodule such that
    $M/S$ is torsion-free, then $M$ is free.
\end{exercise}

The torsion generalizes the concept of elements of finite order in abelian groups. For example, 
 $T(\Z/n)=\Z/n$, $T(\Q)=\{0\}$ and
 \[
 T(\Z\times\Z/3)\simeq T(\Z)\times T(\Z/3)\simeq \{0\}\times\Z/3\simeq\Z/3.
 \]

\begin{example}
    Let $R$ be a ring, viewed as an $R$-module with left multiplication. 
    Then $T(R)=\{r\in R:rs=0\text{ for some non-zero $s\in R$}\}$.
\end{example}

\begin{example}
    Let $M$ be the module (over $\Z$) of
    integer sequences, that is $M=\Z^I$, where 
    $I=\{1,2,3,\dots\}$. Then $T(M)=\{0\}$. 
\end{example}

\begin{example}
If $V$ is a real finite-dimensional vector space and $f\colon V\to V$ 
is a linear transformation, $V$ is a module (over $\R[X]$) 
with 
\[
\left(\sum_{i=0}^m a_iX^i\right)\cdot v=\sum_{i=0}^m a_if^i(v).
\]

We claim that 
$V$ is a torsion module, that is $V=T(V)$. Let $n=\dim V$. If $v\in V$, 
then $\{v,f(v),\dots,f^n(v)\}$ is linearly dependent, as it has 
$n+1$ elements. In particular, there exist $a_0,\dots,a_n\in\R$ not all zero such that
\[
0=\sum_{i=0}^n a_if^i(v)=\left(\sum_{i=0}^n a_iX^i\right)\cdot v.
\]
Thus $v\in T(V)$. 
\end{example}

\begin{theorem}
Let $R$ be a principal domain and 
$M$ be a finitely generated $R$-module. If
$T(M)=\{0\}$, then $M$ is free. 
\end{theorem}

\begin{proof}
Without loss of generality, we may assume that $M$ is non-zero.
By assumption, $M=(X)$ for some finite set $X$. Without loss of generality, we may assume that $0\not\in X$. 
If $x\in X$, then $r\cdot x=0\Longleftrightarrow r=0$, as $T(M)=\{0\}$. 
Let $S=\{x_1,\dots,x_k\}\subseteq X$ 
be maximal with respect to the following property:
\[
r_1\cdot x_1+\cdots+r_k\cdot x_k=0\text{ for $r_1,\dots,r_k\in R$}\implies r_1=\cdots=r_k=0.
\]	
Let $F=(S)$ be the free module with basis $S$. If $X=S$, we are done. 
If $y\in X\setminus S$, then
there exist $r_y,r_1,\dots,r_k\in R$ not all zero such that 
\[
r_y\cdot y+\sum_{i=1}^k r_i\cdot x_i=0.
\]
Since $r_y\cdot y=-\sum_{i=1}^k r_i\cdot x_i\in F$, it follows that
$r_y\ne 0$, as  
$r_y=0$ implies $r_1=\cdots=r_k=0$. Since $X$ is finite, 
\[
r=\prod_{y\in X\setminus S}r_y
\]
is well-defined, as $R$ is commutative and 
$r\cdot X\subseteq F$. If $f\colon M\to M$, $x\mapsto r\cdot x$, then
$f$ is a homomorphism such that $f(M)=r\cdot M$.

% Since $r\cdot X\subseteq F$, it follows that $r\cdot M\subseteq F$
% We claim that $r\cdot M\subseteq M$ is a submodule is a free module. 
% In fact, since $r\cdot X\subseteq F$
Since $T(M)=\{0\}$, it follows that
$\ker f=\{0\}$. Thus 
\[
r\cdot M=f(M)\simeq M.
\]

To finish the proof, we show that $r\cdot M\subseteq F$. Let $m\in M$. Since $M=(X)$, there exist $s_{i_1},\dots,s_{i_m}\in R$
such that 
$m=\sum s_j\cdot x_{i_j}$. Then 
\[
r\cdot m=\sum (rs_{j})\cdot x_{i_j}=\sum s_{j}\cdot (r\cdot x_{i_j})\in F,
\]
as each $r\cdot x_{i_j}\in r\cdot X\subseteq F$. In particular, since 
$R$ is commutative, $r\cdot M$ is a submodule of $F$ and hence $r\cdot M$ is a free module.  
\end{proof}

% todo: explicar mejor la parte final

%\begin{theorem}
%Si $M$ es libre y finitamente generado y $N$ es un submódulo de $M$, entonces $N$ es también libre.
%\end{theorem}

%\begin{proof}
%Sea $\{m_1,\dots,m_k\}$ una base de $M$. Procederemos por inducción en $k$. Para cada $j\in\{1,\dots,k\}$ 
%sea $M_j=M\cap (m_1,\dots,m_j)$. El caso $k=1$ es fácil: 
%como $M_1=M\cap (m_1)\subseteq (m_1)$, existe $r_1\in R$ tal que $M_1=(r_1\cdot m_1)$. Luego $M_1=\{0\}$ o bien
%$M_1$ es libre de rango uno. 
%%Supongamos ahora que $M_j$ es libre de rango $\leq j$. Sea 
%%\[
%%I=\{r\in R:\text{ existe $m\in M$ tal que $m=\sum_{i=1}^j s_j\cdot m_j+r\cdot m_{j+1}$ para $s_1,\dots,s_j\in R$}\}.
%%\]   
%%Como $I$ es un ideal de $R$, podemos escribir $I=(r_{j+1})$, pues $R$ es un dominio de ideales principales. Si $r_{j+1}=0$, entonces
%%$M_{j+1}=M_j$ y el teorema queda demostrado. Si $r_{j+1}\ne 0$, sea $n\in M_{j+1}$ un elemento de la forma
%%\[
%%n=r_{j+1}\cdot m_{j+1}+\cdots, 
%%\]
%%donde usamos la definición del ideal $I$. Si $m\in M_{j+1}$, entonces $m=r\cdot x_{j+1}+\cdots$, donde
%%$r_{j+1}$ divide a $r$, pues como $m\in M$, entonces $r\in I=(a_{j+1})$ y luego $r=sr_{j+1}$ para algún $s\in S$. Como entonces
%%$m-s\cdot n\in M_j=M\cap (m_1,\dots,m_j)$, se concluye que
%%$M_{j+1}=M_j+(n)$. Además $M_j\cap (n)=\{0\}$, pues si $x=r\cdot y=\sum_{i=1}^j r_i\cdot m_i$, entonces
%%\[
%%(rr_{j+1})\cdot m_{j+1}+\sum_{i=1} s_i\cdot m_i=0
%%\]
%%implica que $rr_{j+1}=s_1=\cdots s_j=0$ y luego $r=0$ pues $a_{j+1}\ne 0$. 
%%\end{proof}
%%
%%El teorema anterior también vale en el caso de bases infinitas. La demostración, sin embargo, depende del lema de Zorn.
% todo: referencia al libro de lang

\begin{theorem}
	\label{thm:free+torsion}
	Let $R$ be a principal domain. 
	If $M$ is a finitely generated $R$-module, then $M=T(M)\oplus F$, where
	$F\simeq M/T(M)$ is finitely generated and free. The torsion submodule
	is unique and $F$ is unique up to isomorphism. 
\end{theorem}

\begin{proof}
	We first prove that $T(M/T(M))\simeq\{0\}$. If 
	$x+T(M)\in T(M/T(M))$, then there exists $r\in R\setminus\{0\}$ such that 
	$r\cdot (x+T(M))=T(M)$. Then $r\cdot x\in T(M)$, that is, there exists 
	$s\in R\setminus\{0\}$ such that $s\cdot (r\cdot x)=(sr)\cdot x=0$. 
	Since $sr\ne 0$, it follows that $x\in T(M)$. 

	Since $M$ is finitely generated, $M/T(M)$ is finitely generated. Moreover, $M/T(M)$ is torsion-free. 
	It follows that $M/T(M)$ is free. Consider the exact sequence 
	\[
		\begin{tikzcd}
			0 & T(M) & M & M/T(M) & 0
			\arrow[from=1-1, to=1-2]
			\arrow["\iota", from=1-2, to=1-3]
			\arrow["\pi", from=1-3, to=1-4]
			\arrow[from=1-4, to=1-5]
	\end{tikzcd}\]
	where $\iota$ is the inclusion map and $\pi$ is the canonical map.  Since
	$M/T(M)$ is free, there exists an $R$-module homomorphism $h\colon M/T(M)\to M$
	such that $\pi h=\id$, see Proposition \ref{pro:free=>projective}. This homomorphism
	is needed to prove that $M\simeq
	T(M)\oplus M/T(M)$, see Proposition \ref{pro:split}. 
	 
	Let us prove uniqueness. Suppose that $M=T\oplus L$, where 
	$T$ is a torsion module and $L$ is free. We first prove that
	$T=T(M)$. On the one hand,  
	$T\subseteq T(M)$. On the other hand, if $m\in T(M)$, then
	$m=t+l$ for some $t\in T$ y $l\in L$. In particular, 
	$r\cdot m=0$ and $s\cdot t=0$ for some non-zero $r,s\in R$. Since $R$ is commutative, 
	\[
		0=(rs)\cdot m=(rs)\cdot (t+l)=(rs)\cdot t+(rs)\cdot l=(rs)\cdot l.
	\]
	and thus $l\in T(L)$. Since  
	$L$ is free, $T(L)=\{0\}$ (because $T(L)$ is free and hence every basis element $x$ of  
	$T(L)$ is such that $\{x\}$ is linearly independent, a contradiction). Thus 
	$l=0$ and hence  $m=t\in T$. The free part is unique up to isomorphism 
	because it is isomorphic to $M/T(M)$. 
\end{proof}


%\begin{proof}
%Observemos
%que la función $R\to (m)$, $r\mapsto r\cdot m$, es un epimorfismo de módulos con núcleo
%$\Ann(m)$. Luego $R/\Ann(m)\simeq (m)$ por el primer teorema de isomorfismos. En particular,
%si $\Ann(m)=(p^\alpha)$ para algún irreducible $p\in R$, entonces 
%$(m)\simeq R/(p^\alpha)$.  
%El teorema anterior nos permite descomponer un módulo $p$-primario 
%como suma directa de módulos cíclicos. Observemos que...
%\end{proof}
